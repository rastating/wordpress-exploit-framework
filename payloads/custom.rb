module Wpxf::Payloads
  # A custom payload container.
  class Custom < Wpxf::Payload
    include Wpxf

    def initialize
      super

      unregister_option(get_option('encode_payload'))
      register_options([
        Wpxf::Options::StringOption.new(
          name: 'payload_path',
          required: true,
          desc: 'The path to the custom payload'
        )
      ])
    end

    def encoded
      raw
    end

    def raw
      File.open(datastore['payload_path'], 'rb', &:read)
    end
  end
end
